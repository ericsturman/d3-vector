<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D3 Vector - DNA Visualization</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: row-reverse;
            font-family: Arial, Helvetica, sans-serif;
        }
        #controls {
            width: 300px;
            padding: 20px;
            background-color: #f5f5f5;
            overflow-y: auto;
            height: 100vh;
            box-sizing: border-box;
        }
        #controls h3 {
            margin-top: 0;
        }
        #controls label {
            display: block;
            margin-bottom: 5px;
            font-size: 14px;
            font-weight: bold;
        }
        #controls input[type="number"],
        #controls textarea {
            width: 100%;
            padding: 5px;
            margin-bottom: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }
        #controls textarea {
            font-family: monospace;
            font-size: 12px;
            resize: vertical;
        }
        #controls .error {
            color: red;
            font-size: 12px;
            margin-top: -10px;
            margin-bottom: 15px;
        }
        #visualization-container {
            flex: 1;
            position: relative;
        }
    </style>
</head>
<body>
    <div id="controls">
        <h3>Controls</h3>
        
        <label for="widthInput">Width:</label>
        <input type="number" id="widthInput" />
        
        <label for="heightInput">Height:</label>
        <input type="number" id="heightInput" />
        
        <label for="dataInput">Plasmid Data (JSON):</label>
        <textarea id="dataInput" rows="20"></textarea>
        <div id="parseError" class="error"></div>
        
        <button id="downloadBtn" style="width: 100%; padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; margin-top: 10px;">Download PNG</button>
    </div>
    
    <div id="visualization-container">
        <div id="visualization"></div>
    </div>
    <script>
        // Note: This HTML file contains the control panel.
        // The actual visualization is in the PlasmidVisualization.jsx React component.
        // To use this with React, you'll need to set up a React app and import the component.
        
        let currentData = null;
        let currentWidth = window.innerWidth - 300; // Subtract sidebar width
        let currentHeight = window.innerHeight;

        // Set initial values in inputs
        document.getElementById('widthInput').value = currentWidth;
        document.getElementById('heightInput').value = currentHeight;

        // Load initial data from JSON file
        d3.json('data/example_circular.json').then(data => {
            currentData = data;
            document.getElementById('dataInput').value = JSON.stringify(data, null, 2);
            // TODO: Integrate with React component
            console.log('Data loaded:', data);
            console.log('Width:', currentWidth, 'Height:', currentHeight);
        });

        // Handle width changes
        document.getElementById('widthInput').addEventListener('input', function(e) {
            currentWidth = parseInt(e.target.value) || (window.innerWidth - 300);
            // TODO: Update React component with new width
            console.log('Width changed to:', currentWidth);
        });

        // Handle height changes
        document.getElementById('heightInput').addEventListener('input', function(e) {
            currentHeight = parseInt(e.target.value) || window.innerHeight;
            // TODO: Update React component with new height
            console.log('Height changed to:', currentHeight);
        });

        // Handle data changes
        document.getElementById('dataInput').addEventListener('input', function(e) {
            const errorDiv = document.getElementById('parseError');
            try {
                currentData = JSON.parse(e.target.value);
                errorDiv.textContent = '';
                // TODO: Update React component with new data
                console.log('Data updated:', currentData);
            } catch (error) {
                errorDiv.textContent = 'Invalid JSON: ' + error.message;
            }
        });

        // Download button handler
        document.getElementById('downloadBtn').addEventListener('click', function() {
            // TODO: Call download method on React component
            console.log('Download button clicked');
        });
    </script>
</body>
</html>
